{% extends 'base.html' %}

{% block title %}Secure_BankSys - Search Results{% endblock %}

{% block content %}
<div class="container">
    <h1>Search Results</h1>
    <div class="search-form">
        <form action="/search" method="GET">
            <input type="text" name="q" value="{{ query }}" placeholder="Search accounts or transactions...">
            <button type="submit">Search</button>
        </form>
    </div>
    
    {% if error %}
    <div class="error-box">
        <p>Error executing search: {{ error }}</p>
        <p>Your search query: {{ query }}</p>
    </div>
    {% endif %}
    
    <div class="search-summary">
        <!-- Deliberately vulnerable to XSS - user input is inserted without sanitization -->
        <p>Showing results for: <span class="search-term">{{ query|safe }}</span></p>
    </div>
    
    {% if results %}
    <table>
        <thead>
            <tr>
                <th>Account Number</th>
                <th>Customer Name</th>
                <th>Balance</th>
                <th>Account Type</th>
            </tr>
        </thead>
        <tbody>
            {% for result in results %}
            <tr>
                <td>{{ result[0] }}</td>
                <td>{{ result[1] }}</td>
                <td>${{ '{:,.2f}'.format(result[2]) }}</td>
                <td>{{ result[3] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="no-results">No results found for your search.</p>
    {% endif %}
</div>
{% endblock %}