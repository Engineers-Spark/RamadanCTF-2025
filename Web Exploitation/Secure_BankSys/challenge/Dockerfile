FROM python:3.9-slim
WORKDIR /app
COPY app /app

# Install dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Set environment variables
ENV FLASK_APP=app.py
ENV ADMIN_USERNAME=admin
ENV ADMIN_PASSWORD=SecureB4nkAdm1n!
ENV FLAG=Spark{G00d_J0B_K1nG_Y0u_4R3_C00k1nGG_1ZSQMLK9LQSX21}

# Create dummy image files for static content
RUN mkdir -p static/images
RUN echo "Bank Logo" > static/images/bank-logo.png
RUN echo "Hero Image" > static/images/bank-hero.jpg
RUN echo "Secure Icon" > static/images/secure-icon.png
RUN echo "Fast Icon" > static/images/fast-icon.png
RUN echo "Support Icon" > static/images/support-icon.png

# Create logs directory
RUN mkdir -p /app/logs && chmod 777 /app/logs

# Make sure the database is writable
RUN touch bank.db && chmod 666 bank.db

EXPOSE 4009

CMD ["python", "app.py"]
